\RequirePackage{etoolbox}
\Preamble{xhtml}
\DeclareListParser{\getImgFileParser}{/}


\makeatletter
\newcommand\getImgFile[2]{%
  \def\do##1{\def\imgBaseName{##1.#2}\def\imgBase{##1}}
  \def\ImgFullName{#1.#2}
  \getImgFileParser{#1}
}
  \Configure{graphics*}  
      {pdf}  
      {\Needs{"convert \csname Gin@base\endcsname.pdf  
                            \csname Gin@base\endcsname.png"}%  
\expandafter\getImgFile\expandafter{\Gin@base}{png}
   \Picture[IMG]{\imgBase.png }}  
\Configure{graphics*}
   {gif}
   {\expandafter\getImgFile\expandafter{\Gin@base}{gif}
\Picture[IMG]{\imgBase.gif }}
\Configure{graphics*}
   {png}
{\expandafter\getImgFile\expandafter{\Gin@base}{png}
   \Picture[IMG]{\imgBase.png}}
\Configure{graphics*}
   {jpg}
   {\expandafter\getImgFile\expandafter{\Gin@base}{jpg}
\Picture[IMG]{\imgBase.jpg}}
\Configure{graphics*}
   {jpeg}
   {\expandafter\getImgFile\expandafter{\Gin@base}{jpeg}
\Picture[IMG]{\imgBase.jpeg }}
\Configure{graphics*}
   {svg}
   {\expandafter\getImgFile\expandafter{\Gin@base}{svg}
\Picture[IMG]{\imgBase.svg }}
\catcode`\:=11
\Configure{IMG}
  {\ht:special{t4ht>\ImgFullName.4og}%
\ht:special{t4ht*>}%
\ht:special{t4ht<\ImgFullName.4og}%
\OOmanifest{<manifest:file-entry
    manifest:full-path="Pictures/\imgBaseName"/>\Hnewline
}%
%
   \ht:special{t4ht=<draw:frame
      draw:name="\imgBaseName"
      text:anchor-type="as-char"  % "paragraph"
%      svg:width="...pt"
%      svg:height="...pt"
      draw:z-index="0"
    >%
      <draw:image\Hnewline
         xlink:href="Pictures/}}
  {\ht:special{t4ht=" \Hnewline
         xlink:type="simple"
        xlink:show="embed"
        xlink:actuate="onLoad"
\ifx\noBoundingBox\UnDefined
   \string svg:width="\the\Gin@req@width"
   svg:height="\the\Gin@req@height"
\fi
        /><!--draw:name="}}
  {" }
  {\ht:special{t4ht=" }}
  {\ht:special{t4ht=--></draw:frame>}}
\catcode`\:=12
\makeatother
\begin{document}
\ConfigureEnv{tabular}
    {\HCode{}}{\HCode{}}{}{}
\ConfigureEnv{figure} 
    {\HCode{}}{\HCode{}}{}{}    
% This one removes the rulers. Taking a look at html4.4ht should make 
% clear what has been changed.
\Configure{float}
   {\ifOption{refcaption}{}{\csname par\endcsname\ShowPar \leavevmode}}
   {\HCode{}}
{\ifvmode \IgnorePar \fi\EndP \HCode{}\csname par\endcsname\ShowPar}
\EndPreamble